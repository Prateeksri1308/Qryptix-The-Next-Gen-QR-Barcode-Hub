<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Qryptix ‚Äî 3D Cube</title>
  <link rel="stylesheet" href="theme.css">
  <script type="module" src="theme.js" defer></script>
    <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#000000"/>
  <link rel="icon" type="png" href="favicon-32x32.png" />
  <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png" />
  <link rel="manifest" href="/manifest.webmanifest">
<meta name="theme-color" content="#0D6EFD" />

  <style>
    :root {
  /* Responsive cube size: fits phones/tablets/desktops */
  --size: clamp(180px, 50vmin, 300px); /* smaller and more controlled */
  --speed: 12s;
  --card-bg: #fff;
}

    * { box-sizing: border-box; }
    body { overflow:hidden; margin:0; }

    /* Stage gives perspective */
.cube-container {
  perspective: calc(var(--size) * 4); /* makes perspective scale with cube */
  width: 100vw;
  height: 80vh;
  display: flex;
  justify-content: center;
  align-items: center;
  touch-action: none; /* allow pointer dragging without scroll */
}

    /* WRAP gets user transforms (rotate/flip/zoom) */
    .wrap {
      width: var(--size);
      height: var(--size);
      transform-style: preserve-3d;
      will-change: transform;
      transition: transform 0.18s ease;
    }

    /* CUBE keeps the auto-spin animation; faces are children */
    .cube {
      position: relative;
      width: 100%;
      height: 100%;
      transform-style: preserve-3d;
      animation: spin var(--speed) linear infinite;
    }

    .face {
      position: absolute;
      width: 100%;
      height: 100%;
      backface-visibility: hidden;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 4px 12px rgba(0,0,0,0.12);
      border: 2px solid rgba(255,255,255,0.15);
    }
    .face img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      background: var(--card-bg, #fff);
      /* keep QR crisp when scaled */
      image-rendering: pixelated;
      image-rendering: crisp-edges;
    }

    /* Place faces half the cube depth away */
    .face.front  { transform: rotateY(  0deg) translateZ(calc(var(--size)/2)); }
    .face.back   { transform: rotateY(180deg) translateZ(calc(var(--size)/2)); }
    .face.right  { transform: rotateY( 90deg) translateZ(calc(var(--size)/2)); }
    .face.left   { transform: rotateY(-90deg) translateZ(calc(var(--size)/2)); }
    .face.top    { transform: rotateX( 90deg) translateZ(calc(var(--size)/2)); }
    .face.bottom { transform: rotateX(-90deg) translateZ(calc(var(--size)/2)); }

    @keyframes spin {
      from { transform: rotateX(0) rotateY(0); }
      to   { transform: rotateX(360deg) rotateY(360deg); }
    }
   #speed-label {
  position: relative;
  display: inline-block;
  font-size: 14px;
  font-weight: 500;
  width: 200px; /* adjust slider width */
}

#speedRange {
  width: 100%;
  margin-top: 12px;
}

#speedText {
  position: absolute;
  top: -35px; /* above the slider */
  transform: translateX(0);
  display: inline-block;
  padding: 6px 12px;
  border-radius: 16px;
  background: linear-gradient(135deg, #6a11cb, #2575fc);
  color: #fff;
  font-weight: 600;
  font-size: 13px;
  box-shadow: 0 4px 16px rgba(0,0,0,0.25);
  transition: transform 0.1s ease;
  pointer-events: none;
  white-space: nowrap;
}

    .controls {
      position: fixed;
      bottom: 5px; left: 50%;
      transform: translateX(-50%);
      display: flex; flex-wrap: wrap; gap: 12px;
      align-items: center; justify-content: center;
      background: var(--card-bg, #fff);
      padding: 10px 14px;
      border-radius: 14px;
      box-shadow: 0 8px 24px rgba(0,0,0,0.12);
    }
    .controls label { font-size: 14px; display:flex; align-items:center; gap:8px; }

    .footer { text-align:center; margin:8px; font-size:14px; }
  </style>
</head>
<body>
  <!-- Futuristic Loader -->
<div id="page-loader">
  <div class="loader-container">
    <div class="logo-spin">
      <img src="favicon-32x32.png" alt="Logo" />
    </div>
    <div class="dots">
      <span></span><span></span><span></span>
    </div>
    <div class="status-text">
      <span id="loader-text">Loading...</span>
    </div>
    <div class="progress-bar">
      <div class="progress-fill"></div>
    </div>
  </div>
</div>
  <!-- HEADER -->
  <header class="header">
    <nav class="nav container">
      <div class="brand"><div class="brand-logo"></div><span>Qryptix</span></div>
      <div class="nav-links desktop-only">
        <a data-softnav href="index.html" class="btn sm">Home</a>
        <a data-softnav href="studio.html" class="btn sm">Studio</a>
        <a data-softnav href="scanner.html" class="btn sm">Scanner</a>
        <button class="btn icon" data-theme-toggle title="Toggle theme">üåì</button>
      </div>
      <button class="hamburger" aria-label="Menu"><span></span><span></span><span></span></button>
    </nav>
  </header>

  <div class="drawer-backdrop"></div>
    <aside class="mobile-drawer">
  <div class="drawer-head">
    <div class="brand"><div class="brand-logo"></div>Qryptix</div>
    <button class="close-btn">&times;</button>
  </div>

  <nav class="nav-links" style="flex-direction:column;gap:12px;flex:1;display:flex;">
    <div class="drawer-top" style="display:flex;flex-direction:column;gap:12px;">
      <a data-softnav href="index.html" class="btn sm">Home</a>
      <a data-softnav href="studio.html" class="btn sm">Studio</a>
      <a data-softnav href="scanner.html" class="btn sm">Scanner</a>
    <a id="download-btn" href="app-release-signed.apk" class="btn animated-btn primary-btn" download target="_blank" rel="noopener noreferrer">Download APK ‚¨áÔ∏è</a>
      <button class="btn icon" data-theme-toggle>üåì</button>
    </div>

    <div class="drawer-bottom">
      <a href="https://github.com/Prateeksri1308/" target="_blank" class="btn sm ghost drawer-btn github">GitHub</a>
      <a href="https://www.linkedin.com/in/prateek-srivastava-backend/" target="_blank" class="btn sm ghost drawer-btn linkedin">LinkedIn</a>
    </div>
  </nav>
</aside>

  <!-- CUBE STAGE -->
  <main class="cube-container">
    <div id="wrap" class="wrap">
      <div id="cube" class="cube">
        <div class="face front"><img id="qr1" alt="QR face 1"></div>
        <div class="face back"><img id="qr2" alt="QR face 2"></div>
        <div class="face right"><img id="qr3" alt="QR face 3"></div>
        <div class="face left"><img id="qr4" alt="QR face 4"></div>
        <div class="face top"><img id="qr5" alt="QR face 5"></div>
        <div class="face bottom"><img id="qr6" alt="QR face 6"></div>
      </div>
    </div>

  <div class="controls">
    <button id="pauseBtn" class="btn primary">‚è∏ Pause</button>
    <!-- <button id="resetBtn" class="btn ghost">üîÑ Reset</button> -->
    <button id="flipBtn"  class="btn ghost">üåÄ Flip</button>
   <label id="speed-label">Speed
  <input id="speedRange" type="range" min="5" max="30" value="12">
  <span id="speedText">12s</span>
</label>

  </div>
<div id="drag-guide">
  <div class="arrows">
    <span class="arrow up">‚¨Ü</span>
    <span class="arrow down">‚¨á</span>
    <span class="arrow left">‚¨Ö</span>
    <span class="arrow right">‚û°</span>
  </div>
  <p class="hint">Drag to Explore</p>
</div>


  </main>
 <a id="download-btn" href="app-release-signed.apk" class="floating-apk-btn" download target="_blank" rel="noopener noreferrer">
  üì± Get App
</a>
  <footer class="footer">Made with ‚ù§Ô∏è by <strong>Prateek</strong></footer>

  <script>
       const floatBtn = document.querySelector(".floating-apk-btn");

window.addEventListener("scroll", () => {
  if (window.scrollY === 0) {
    // At top ‚Üí show button
    floatBtn.style.opacity = "1";
    floatBtn.style.pointerEvents = "auto";
  } else {
    // Scrolled down ‚Üí hide button
    floatBtn.style.opacity = "0";
    floatBtn.style.pointerEvents = "none";
  }
});
    // Elements
    const wrap = document.getElementById("wrap");
    const cube = document.getElementById("cube");
    const pauseBtn = document.getElementById("pauseBtn");
    // const resetBtn = document.getElementById("resetBtn");
    const flipBtn  = document.getElementById("flipBtn");
    const speedRange = document.getElementById("speedRange");
    const speedText = document.getElementById("speedText");
    // State for user transforms (applied to WRAP, not the cube animation)
    let rotX = 0, rotY = 0;
    let scale = 1;
    let flipped = false;
    let paused = false;

    function applyWrapTransform(){
      // Compose transforms on the wrapper so reset/flip/zoom never fight the cube animation
      const flipScaleX = flipped ? -1 : 1;
      wrap.style.transform = `scaleX(${flipScaleX}) rotateX(${rotX}deg) rotateY(${rotY}deg) scale(${scale})`;
    }

    // Pause / Resume only affects the cube's animation
    pauseBtn.addEventListener("click", () => {
      paused = !paused;
      cube.style.animationPlayState = paused ? "paused" : "running";
      pauseBtn.textContent = paused ? "‚ñ∂ Resume" : "‚è∏ Pause";
    });


//speed 
// Initialize display
function updateSpeedText() {
  const min = parseInt(speedRange.min);
  const max = parseInt(speedRange.max);
  const val = parseInt(speedRange.value);
  
  // Update text
  speedText.textContent = val + "s";

  // Calculate position (0% to 100% of slider)
  const percent = (val - min) / (max - min);

  // Slider width minus some padding
  const sliderWidth = speedRange.offsetWidth;
  const bubbleWidth = speedText.offsetWidth;

  // Position bubble center to slider thumb
  const offset = percent * (sliderWidth - 16) - (bubbleWidth / 2) + 8; 
  speedText.style.transform = `translateX(${offset}px)`;
}

// Initialize
updateSpeedText();

// Update on input
speedRange.addEventListener("input", updateSpeedText);

    // Reset: returns wrapper to default (also unflips & unzoom)
    // Reset: returns wrapper to default (unflips & unzooms & resets rotation)
/* resetBtn.addEventListener("click", () => {
  // Reset user transforms
  rotX = 0;
  rotY = 0;
  scale = 1;
  flipped = false;

  // Reset flip button
  flipBtn.classList.remove("active");

  // Temporarily add smooth transition
  wrap.style.transition = "transform 0.3s ease";

  // Apply default transform
  wrap.style.transform = `scaleX(1) rotateX(0deg) rotateY(0deg) scale(1)`;

  // Resume cube animation
  cube.style.animationPlayState = "running";

  // Reset pause state and button text
  paused = false;
  pauseBtn.textContent = "‚è∏ Pause";

  // After transition, restore normal transition
  setTimeout(() => { wrap.style.transition = "transform 0.18s ease"; }, 300);

  // Reset dragging state
  dragging = false;
}); */
  function fixCubeTransforms() {
  const wrap = document.querySelector('.wrap');
  if (!wrap) return;

  const faces = document.querySelectorAll('.face');
  if (!faces.length) return;

  const cubeSize = wrap.offsetWidth / 2; // half of cube size

  faces[0].style.transform = `rotateY(0deg) translateZ(${cubeSize}px)`;
  faces[1].style.transform = `rotateY(180deg) translateZ(${cubeSize}px)`;
  faces[2].style.transform = `rotateY(90deg) translateZ(${cubeSize}px)`;
  faces[3].style.transform = `rotateY(-90deg) translateZ(${cubeSize}px)`;
  faces[4].style.transform = `rotateX(90deg) translateZ(${cubeSize}px)`;
  faces[5].style.transform = `rotateX(-90deg) translateZ(${cubeSize}px)`;
}

window.addEventListener('load', fixCubeTransforms);
window.addEventListener('resize', fixCubeTransforms);


    // Flip: inside-out effect (mirror on X)
    flipBtn.addEventListener("click", () => {
      flipped = !flipped;
      applyWrapTransform();
      flipBtn.classList.toggle("active", flipped);
    });

    // Speed control (animation duration)
    speedRange.addEventListener("input", () => {
      const s = `${speedRange.value}s`;
      cube.style.animationDuration = s;
      // Keep paused state if currently paused
      if (paused) cube.style.animationPlayState = "paused";
    });
    // Pointer drag rotate (mouse + touch via Pointer Events)
    let dragging = false, lastX = 0, lastY = 0, wasPausedDuringDrag = false;
    function onPointerDown(e){
      dragging = true;
      lastX = e.clientX; lastY = e.clientY;
      // Temporarily pause spin while dragging, remember prior state
      wasPausedDuringDrag = paused;
      cube.style.animationPlayState = "paused";
      e.preventDefault();
    }
    function onPointerMove(e){
      if(!dragging) return;
      const dx = e.clientX - lastX;
      const dy = e.clientY - lastY;
      rotY += dx * 0.3;
      rotX -= dy * 0.3;
      lastX = e.clientX; lastY = e.clientY;
      applyWrapTransform();
    }
    function onPointerUp(){
      if(!dragging) return;
      dragging = false;
      // Restore pause state after drag
      cube.style.animationPlayState = wasPausedDuringDrag ? "paused" : "running";

      // Hide drag guide on first interaction
const dragGuide = document.getElementById("drag-guide");
if (dragGuide && !dragGuide.classList.contains("hide")) {
  dragGuide.classList.add("hide");
}

    }
    wrap.addEventListener("pointerdown", onPointerDown);
    window.addEventListener("pointermove", onPointerMove);
    window.addEventListener("pointerup", onPointerUp);

    // Double-tap / Double-click zoom toggle
    let lastTapTime = 0;
    function handleTap(){
      const now = Date.now();
      if (now - lastTapTime < 300) {
        scale = (scale === 1) ? 1.3 : 1; // toggle zoom
        applyWrapTransform();
      }
      lastTapTime = now;
    }
    wrap.addEventListener("pointerup", handleTap);

    // Load QR (saved via QRPRO, otherwise fallback)
    function loadQR(){
      let png = null;
      try { png = window.QRPRO?.getLastQRPng?.(); } catch (e) {}
      const fallback = "https://api.qrserver.com/v1/create-qr-code/?size=420x420&data=Hello";
      const src = png || fallback;
      for (let i = 1; i <= 6; i++) {
        const el = document.getElementById("qr"+i);
        el.src = src;
        el.alt = "QR face " + i;
      }
    }

    // Init
    loadQR();
    applyWrapTransform();
  </script>
</body>
</html>
